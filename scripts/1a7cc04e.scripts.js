"use strict";angular.module("socialCounterApp",["ngRoute"]).config(["$routeProvider",function(a){a.when("/",{}).when("/:targetUrl",{templateUrl:"views/main.html",controller:"MainCtrl"})}]),angular.module("socialCounterApp").factory("GssManip",["$rootScope","$http",function(a,b){function c(b,c){this.ssid=b,this.sid=c,this.jsonUrl="https://spreadsheets.google.com/feeds/cells/"+this.ssid+"/"+this.sid+"/public/basic?alt=json-in-script&callback=JSON_CALLBACK",this.data=null,this.callback=null,this.$event=a.$new(),this.loadQueue=[],this.onloaded(angular.bind(this,function(){this.callback(this.getData()),this.postprocess(),this.loadQueue.length>0&&this._load.apply(this,this.loadQueue.shift())}))}return c.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},c.prototype.preprocess=function(){this.data=null},c.prototype.postprocess=function(){this.callback=null},c.prototype.onloaded=function(a){this.$event.$on("loaded",a)},c.prototype.loaded=function(){this.$event.$emit("loaded")},c.prototype.done=function(a){this.data=this.parseFeedEntry(a.data.feed.entry)},c.prototype.fail=function(){this.data=null},c.prototype.always=function(){this.loaded()},c.prototype.ajax=function(){return b.jsonp(this.jsonUrl,{method:"GET"}).then(angular.bind(this,this.done),angular.bind(this,this.fail))["finally"](angular.bind(this,this.always))},c.prototype.parseFeedEntry=function(a){var b=[],d=[];return angular.forEach(a,function(a){var e,f,g,h,i;e=a.id.$t.match(/R(\d+)C(\d+)$/),f=parseInt(e[1],10)-2,g=parseInt(e[2],10)-1,h=a.content.$t,0>f?b[g]=c.trim(h):(d[f]||(d[f]={}),i=null!==b[g]?b[g]:"C"+(g+1),d[f][i]=h)}),angular.forEach(d,function(a){angular.forEach(b,function(b){null===a[b]&&(a[b]="")})}),d},c.prototype.getData=function(){return null!==this.data?angular.extend([],this.data):null},c.prototype._load=function(a,b){this.callback=a||angular.noop,null===this.data||b?(this.preprocess(),this.ajax()):this.loaded()},c.prototype.load=function(a,b){null===this.callback?this._load(a,b):this.loadQueue.push(arguments)},c.prototype.reload=function(a){this.load(a,!0)},c}]),angular.module("socialCounterApp").controller("ErrorCtrl",["$scope",function(a){a.isError=!1,a.$on("onError",function(){a.isError=!0}),a.$on("onSuccess",function(){a.isError=!1})}]),angular.module("socialCounterApp").controller("InputCtrl",["$scope","$location",function(a,b){function c(a){return-1!==a.indexOf("https://docs.google.com")}function d(a){var b,c,d,e,f=0,g={};if(""===a)return g;for(a=a.replace(/^\?/,""),b=a.split("&"),e=b.length;e>f;f++)c=b[f],d=c.split("="),g[d[0]]=decodeURIComponent(d[1]);return g}var e="";a.onSubmit=function(a){var f,g;e=a.trim(),""!==a&&(c(a)?(g=a.split("?")[1],f=d(g).key,b.path(f)):b.path(encodeURIComponent(e)))},a.onKeyUp=function(b,c){13===b.keyCode&&a.onSubmit(c)}}]),angular.module("socialCounterApp").controller("MainCtrl",["$scope","$routeParams","GssManip","$rootScope",function(a,b,c,d){function e(a){return-1!==a.indexOf("http")}function f(a){return-1!==a.indexOf("javascript:")}function g(a){return[{title:"",url:a}]}var h,i=a.targetUrl=decodeURIComponent(b.targetUrl);a.$watch("targetUrl",function(){f(i)||(e(i)?(a.data=g(i),d.$broadcast("onSuccess")):(h=new c(i,"od6"),h.load(function(b){b?d.$broadcast("onSuccess"):d.$broadcast("onError"),a.data=b})))})}]),angular.module("socialCounterApp").directive("like",[function(){return{restrict:"E",template:'<iframe src="//www.facebook.com/plugins/like.php?href=%url%&amp;width=120&amp;layout=button_count&amp;action=like&amp;show_faces=true&amp;share=false&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:21px;" allowTransparency="true"></iframe>',link:function(a,b,c){var d=encodeURIComponent(c.url);b[0].outerHTML=b[0].outerHTML.replace("%url%",d)}}}]),angular.module("socialCounterApp").directive("tweet",[function(){return{restrict:"E",template:'<a data-url="%url%" href="https://twitter.com/share" class="twitter-share-button" data-lang="en">Tweet</a>',link:function(a,b,c){var d=c.url;b[0].outerHTML=b[0].outerHTML.replace("%url%",d),a.$last&&b.ready(function(){twttr.widgets.load()})}}}]),angular.module("socialCounterApp").directive("plusone",[function(){return{restrict:"E",template:'<div class="g-plusone" data-size="medium" data-href="%url%"></div>',link:function(a,b,c){var d=c.url;b[0].outerHTML=b[0].outerHTML.replace("%url%",d),a.$last&&b.ready(function(){gapi.plusone.go("result")})}}}]),angular.module("socialCounterApp").directive("pocket",[function(){return{restrict:"E",template:'<a data-pocket-label="pocket" data-pocket-count="horizontal" class="pocket-btn" data-save-url="%url%" data-lang="en"></a>',link:function(a,b,c){var d=c.url;b[0].outerHTML=b[0].outerHTML.replace("%url%",d),a.$last&&b.ready(function(){var a,b=document,c="pocket-btn-js",d=b.createElement("script");d.id=c,d.src="https://widgets.getpocket.com/v1/j/btn.js?v=1",a=b.getElementById(c),b.body.appendChild(d)})}}}]);